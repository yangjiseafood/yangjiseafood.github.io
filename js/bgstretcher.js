(function(a){var j=null,k="",b="",u=!1,n=!1,s=null,h=[],r=[],v=0,m=[];a.fn.bgStretcher=function(c){function f(d){var f=0,e=0,g=0,h=0;a("BODY").hasClass("bgStretcher-container")?(f=a(window).width(),e=a(window).height(),a.browser.msie&&6==parseInt(jQuery.browser.version)&&a(window).scroll(function(){a("#"+c.imageContainer).css("top",a(window).scrollTop())})):(a(".bgstretcher").css("position","absolute").css("top","0px"),f=d.width(),e=d.height());var q=d=0,h="auto"!=c.maxWidth?f>c.maxWidth?c.maxWidth:
f:f,g="auto"!=c.maxHeight?e>c.maxHeight?c.maxHeight:e:e;j.width(h);j.height(g);if(c.resizeProportionally){var o=c.imageHeight/c.imageWidth,d=h,q=Math.round(h*o);q<g&&(q=g,d=Math.round(q/o))}else q=d=g;var n=o=0,p;"left top"!=a.fn.bgStretcher.settings.anchoring&&(p=a.fn.bgStretcher.settings.anchoring.split(" "),"right"==p[0]?o=f-h:"center"==p[0]&&(o=Math.round((f-h)/2)),"bottom"==p[1]?n=e-g:"center"==p[1]&&(n=Math.round((e-g)/2)),j.css("marginLeft",o+"px").css("marginTop",n+"px"));n=o=0;"left top"!=
a.fn.bgStretcher.settings.anchoringImg&&(p=a.fn.bgStretcher.settings.anchoringImg.split(" "),"right"==p[0]?o=h-d:"center"==p[0]&&(o=Math.round((h-d)/2)),"bottom"==p[1]?n=g-q:"center"==p[1]&&(n=Math.round((g-q)/2)));m.mar_left=o;m.mar_top=n;j.find("LI:first").hasClass("swf-mode")&&(j.find("LI:first").html(),j.find("LI:first").html('<div id="bgstretcher-flash">&nbsp;</div>'),f=new SWFObject("flash/stars.swf","flash-obj",h,g,"9"),f.addParam("wmode","transparent"),f.write("bgstretcher-flash"));m.imgW=
d;m.imgH=q;c.resizeAnimate?(j.children("UL").children("LI.img-loaded").find("IMG").animate({marginLeft:m.mar_left+"px",marginTop:m.mar_top+"px"},"normal"),j.children("UL").children("LI.img-loaded").find("IMG").animate({width:m.imgW+"px",height:m.imgH+"px"},"normal")):(j.children("UL").children("LI.img-loaded").find("IMG").css({marginLeft:m.mar_left+"px",marginTop:m.mar_top+"px"}),j.children("UL").children("LI.img-loaded").find("IMG").css({width:m.imgW+"px",height:m.imgH+"px"}));a(k).width(j.width()).height(j.height());
"simpleSlide"==a.fn.bgStretcher.settings.transitionEffect&&("W"==a.fn.bgStretcher.settings.slideDirection||"E"==a.fn.bgStretcher.settings.slideDirection?(j.children("UL").width(j.width()*a(k).length).height(j.height()),-1!=a(b+" LI").index(a(b+" LI.bgs-current"))&&(l=-1*a(b+" LI").index(a(b+" LI.bgs-current"))*j.width(),j.children("UL").css({left:l+"px"}))):(j.children("UL").height(j.height()*a(k).length).width(j.width()),-1!=a(b+" LI").index(a(b+" LI.bgs-current"))&&(t=-1*a(b+" LI").index(a(b+" LI.bgs-current"))*
a(b).height(),j.children("UL").css({top:t+"px"}))))}if(a(".bgstretcher-page").length||a(".bgstretcher-area").length)return"undefined"!==typeof console&&null!=console&&console.log("More than one bgStretcher"),!1;c=a.extend({},a.fn.bgStretcher.defaults,c);a.fn.bgStretcher.settings=c;this.addClass("bgStretcher-container");var e=this;if(c.images.length){var d="",g;e.each(function(){a(this).wrapInner('<div class="bgstretcher-page" />').wrapInner('<div class="bgstretcher-area" />');d='<div id="'+c.imageContainer+
'" class="bgstretcher"><ul>';if(c.images.length){var b=c.images[0].split("."),b=b[b.length-1];if("swf"!=b)for(i=b=0;i<c.images.length;i++)b="simpleSlide"==c.transitionEffect&&"back"==c.sequenceMode?c.images.length-1-i:i,d=a.fn.bgStretcher.settings.preloadImg?d+('<li><span class="image-path">'+c.images[b]+"</span></li>"):d+('<li class="img-loaded"><img src="'+c.images[b]+'" alt="" /></li>');else d+='<li class="swf-mode">'+c.images[0]+"</li>"}d+="</ul></div>";g=a(this).children(".bgstretcher-area");
a(d).prependTo(g);g.css({position:"relative"});g.children(".bgstretcher-page").css({position:"relative","z-index":3})});b="#"+c.imageContainer;j=a(b);k="#"+c.imageContainer+" LI";a(k).hide().css({"z-index":1,overflow:"hidden"});if(j.length){a(window).resize(function(){f(e)});f(e);var h=0;if("simpleSlide"==c.transitionEffect){"random"==c.sequenceMode&&("undefined"!==typeof console&&null!=console)&&(console.log("Effect 'simpleSlide' don't be to use with mode random."),console.log("Mode was automaticly set in normal."));
a(k).css({"float":"left",position:"static"});a(k).show();if("NW"==a.fn.bgStretcher.settings.slideDirection||"NE"==a.fn.bgStretcher.settings.slideDirection)a.fn.bgStretcher.settings.slideDirection="N";if("SW"==a.fn.bgStretcher.settings.slideDirection||"SE"==a.fn.bgStretcher.settings.slideDirection)a.fn.bgStretcher.settings.slideDirection="S";"S"==a.fn.bgStretcher.settings.slideDirection||"E"==a.fn.bgStretcher.settings.slideDirection?(c.sequenceMode="back",a(k).removeClass("bgs-current"),a(k).eq(a(k).length-
a.fn.bgStretcher.settings.startElementIndex-1).addClass("bgs-current"),"E"==a.fn.bgStretcher.settings.slideDirection?(l=-1*a(b+" LI").index(a(b+" LI.bgs-current"))*a(b).width(),t=0):(t=-1*a(b+" LI").index(a(b+" LI.bgs-current"))*a(b).height(),l=0),a(b+" UL").css({left:l+"px",top:t+"px"})):(c.sequenceMode="normal",0!=a.fn.bgStretcher.settings.startElementIndex&&("N"==a.fn.bgStretcher.settings.slideDirection?(t=-1*a(b+" LI").index(a(b+" LI.bgs-current"))*a(b).height(),l=0):(l=-1*a(b+" LI").index(a(b+
" LI.bgs-current"))*a(b).width(),t=0,console.log(l)),a(b+" UL").css({left:l+"px",top:t+"px"})))}if(a(c.buttonNext).length||a(c.buttonPrev).length||a(c.pagination).length)"random"==c.sequenceMode?"undefined"!==typeof console&&null!=console&&console.log("Don't use random mode width prev-button, next-button and pagination."):(a(c.buttonPrev).length&&(a(c.buttonPrev).addClass("bgStretcherNav bgStretcherNavPrev"),a(c.buttonPrev).click(function(){a.fn.bgStretcher.buttonSlide("prev")})),a(c.buttonNext).length&&
(a(c.buttonNext).addClass("bgStretcherNav bgStretcherNavNext"),a(c.buttonNext).click(function(){a.fn.bgStretcher.buttonSlide("next")})),a(c.pagination).length&&a.fn.bgStretcher.pagination());if("random"==c.sequenceMode)h=Math.floor(Math.random()*a(k).length),a.fn.bgStretcher.buildRandom(h),"simpleSlide"!=c.transitionEffect&&(a.fn.bgStretcher.settings.startElementIndex=h);else if(a.fn.bgStretcher.settings.startElementIndex>a(k).length-1&&(a.fn.bgStretcher.settings.startElementIndex=0),h=a.fn.bgStretcher.settings.startElementIndex,
"simpleSlide"==c.transitionEffect&&("S"==a.fn.bgStretcher.settings.slideDirection||"E"==a.fn.bgStretcher.settings.slideDirection))h=a(k).length-1-a.fn.bgStretcher.settings.startElementIndex;a(k).eq(h).show().addClass("bgs-current");a.fn.bgStretcher.loadImg(a(k).eq(h));c.slideShow&&1<a(k).length&&(s=setTimeout("jQuery.fn.bgStretcher.slideShow('"+jQuery.fn.bgStretcher.settings.sequenceMode+"', -1)",c.nextSlideDelay))}}};a.fn.bgStretcher.loadImg=function(c){if(c.hasClass("img-loaded"))return!0;c.find("SPAN.image-path").each(function(){var c=
a(this).html(),b=a(this).parent(),d=new Image;a(d).load(function(){a(this).hide();b.prepend(this);a(this).fadeIn("100")}).error(function(){}).attr("src",c).attr("alt","");a(d).css({marginLeft:m.mar_left+"px",marginTop:m.mar_top+"px"});a(d).css({width:m.imgW+"px",height:m.imgH+"px"})});c.addClass("img-loaded");return!0};a.fn.bgStretcher.play=function(){u=!1;a.fn.bgStretcher._clearTimeout();a.fn.bgStretcher.slideShow(a.fn.bgStretcher.settings.sequenceMode,-1)};a.fn.bgStretcher._clearTimeout=function(){null!=
s&&(clearTimeout(s),s=null)};a.fn.bgStretcher.pause=function(){u=!0;a.fn.bgStretcher._clearTimeout()};a.fn.bgStretcher.sliderDestroy=function(){var c=a(".bgstretcher-page").html();a(".bgStretcher-container").html("").html(c).removeClass("bgStretcher-container");a.fn.bgStretcher._clearTimeout();u=!1};a.fn.bgStretcher.slideShow=function(c,f){n=!0;if(2>a(k).length)return!0;var e=a(b+" LI.bgs-current"),d;a(e).stop(!0,!0);if(-1==f)switch(c){case "back":d=e.prev();d.length||(d=a(b+" LI:last"));break;case "random":v==
a(b+" LI").length&&(a.fn.bgStretcher.buildRandom(h[a(b+" LI").length-1]),v=0);d=a(b+" LI").eq(h[v]);v++;break;default:d=e.next(),d.length||(d=a(b+" LI:first"))}else d=a(b+" LI").eq(f);a(b+" LI").removeClass("bgs-current");a.fn.bgStretcher.loadImg(d);d.addClass("bgs-current");switch(a.fn.bgStretcher.settings.transitionEffect){case "fade":a.fn.bgStretcher.effectFade(e,d);break;case "simpleSlide":a.fn.bgStretcher.simpleSlide();break;case "superSlide":a.fn.bgStretcher.superSlide(e,d,c);break;default:a.fn.bgStretcher.effectNone(e,
d)}a(a.fn.bgStretcher.settings.pagination).find("LI").length&&(a(a.fn.bgStretcher.settings.pagination).find("LI.showPage").removeClass("showPage"),a(a.fn.bgStretcher.settings.pagination).find("LI").eq(a(b+" LI").index(a(b+" LI.bgs-current"))).addClass("showPage"));a.fn.bgStretcher.settings.callbackfunction&&"function"==typeof a.fn.bgStretcher.settings.callbackfunction&&a.fn.bgStretcher.settings.callbackfunction.call();u||(s=setTimeout("jQuery.fn.bgStretcher.slideShow('"+jQuery.fn.bgStretcher.settings.sequenceMode+
"', -1)",jQuery.fn.bgStretcher.settings.nextSlideDelay))};a.fn.bgStretcher.effectNone=function(a,b){b.show();a.hide();n=!1};a.fn.bgStretcher.effectFade=function(c,b){b.fadeIn(a.fn.bgStretcher.settings.slideShowSpeed);c.fadeOut(a.fn.bgStretcher.settings.slideShowSpeed,function(){n=!1})};a.fn.bgStretcher.simpleSlide=function(){var c,f;switch(a.fn.bgStretcher.settings.slideDirection){case "N":case "S":c=-1*a(b+" LI").index(a(b+" LI.bgs-current"))*a(b).height();f=0;break;default:f=-1*a(b+" LI").index(a(b+
" LI.bgs-current"))*a(b).width(),c=0}a(b+" UL").animate({left:f+"px",top:c+"px"},a.fn.bgStretcher.settings.slideShowSpeed,function(){n=!1})};a.fn.bgStretcher.superSlide=function(c,f,e){var d,g;switch(a.fn.bgStretcher.settings.slideDirection){case "S":d=a(b).height();g=0;break;case "E":d=0;g=a(b).width();break;case "W":d=0;g=-1*a(b).width();break;case "NW":d=-1*a(b).height();g=-1*a(b).width();break;case "NE":d=-1*a(b).height();g=a(b).width();break;case "SW":d=a(b).height();g=-1*a(b).width();break;
case "SE":d=a(b).height();g=a(b).width();break;default:d=-1*a(b).height(),g=0}"back"==e?(f.css({"z-index":2,top:d+"px",left:g+"px"}),f.show(),f.animate({left:"0px",top:"0px"},a.fn.bgStretcher.settings.slideShowSpeed,function(){c.hide();a(this).css({"z-index":1});n=!1})):(c.css("z-index",2),f.show(),c.animate({left:g+"px",top:d+"px"},a.fn.bgStretcher.settings.slideShowSpeed,function(){a(this).hide().css({"z-index":1,top:"0px",left:"0px"});n=!1}))};a.fn.bgStretcher.buildRandom=function(c){var b=a(k).length,
e,d,g;for(e=0;e<b;e++)h[e]=e,r[e]=Math.random()*b;for(e=0;e<b;e++)for(d=0;d<b-e-1;d++)r[d]>r[d+1]&&(g=r[d],r[d]=r[d+1],r[d+1]=g,g=h[d],h[d]=h[d+1],h[d+1]=g);h[0]==c&&(g=h[0],h[0]=h[b-1],h[b-1]=g)};a.fn.bgStretcher.buttonSlide=function(b){if(n||2>a(k).length)return!1;var f="";"prev"==b?(f="back","back"==a.fn.bgStretcher.settings.sequenceMode&&(f="normal")):f=a.fn.bgStretcher.settings.sequenceMode;a(k).stop(!0,!0);a.fn.bgStretcher._clearTimeout();a.fn.bgStretcher.slideShow(f,-1);return!1};a.fn.bgStretcher.pagination=
function(){var b=a(k).length,f,e=0;if(0<b){f="<ul>";for(e=0;e<b;e++)f+='<li><a href="javascript:;">'+(e+1)+"</a></li>";a(a.fn.bgStretcher.settings.pagination).html(f+"</ul>");a(a.fn.bgStretcher.settings.pagination).find("LI:first").addClass("showPage");a(a.fn.bgStretcher.settings.pagination).find("A").click(function(){if(a(this).parent().hasClass("showPage"))return!1;a(k).stop(!0,!0);a.fn.bgStretcher._clearTimeout();a.fn.bgStretcher.slideShow(a.fn.bgStretcher.settings.sequenceMode,a(a.fn.bgStretcher.settings.pagination).find("A").index(a(this)));
return!1})}return!1};a.fn.bgStretcher.defaults={imageContainer:"bgstretcher",resizeProportionally:!0,resizeAnimate:!1,images:[],imageWidth:1024,imageHeight:768,maxWidth:"auto",maxHeight:"auto",nextSlideDelay:3E3,slideShowSpeed:"normal",slideShow:!0,transitionEffect:"fade",slideDirection:"N",sequenceMode:"normal",buttonPrev:"",buttonNext:"",pagination:"",anchoring:"left top",anchoringImg:"left top",preloadImg:!1,startElementIndex:0,callbackfunction:null};a.fn.bgStretcher.settings={}})(jQuery);